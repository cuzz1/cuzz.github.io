<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>深入理解 synchronized 关键字 - cuzz&#039;s blog</title><meta description="博客记录"><meta property="og:type" content="blog"><meta property="og:title" content="深入理解 synchronized 关键字"><meta property="og:url" content="http://blog.cuzz.site/2020/09/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20synchronized%20%E5%85%B3%E9%94%AE%E5%AD%97/"><meta property="og:site_name" content="cuzz&#039;s blog"><meta property="og:description" content="博客记录"><meta property="og:locale" content="en_US"><meta property="og:image" content="http://img.cuzz.site/2020/4491294-e3bcefb2bacea224-20200910141026692.png"><meta property="og:image" content="http://img.cuzz.site/20200911165817.png"><meta property="article:published_time" content="2020-09-09T15:59:59.000Z"><meta property="article:modified_time" content="2020-09-11T10:15:56.860Z"><meta property="article:author" content="cuzz"><meta property="article:tag" content="synchronized"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="http://img.cuzz.site/2020/4491294-e3bcefb2bacea224-20200910141026692.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.cuzz.site/2020/09/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20synchronized%20%E5%85%B3%E9%94%AE%E5%AD%97/"},"headline":"cuzz's blog","image":["http://img.cuzz.site/2020/4491294-e3bcefb2bacea224-20200910141026692.png","http://img.cuzz.site/20200911165817.png"],"datePublished":"2020-09-09T15:59:59.000Z","dateModified":"2020-09-11T10:15:56.860Z","author":{"@type":"Person","name":"John Doe"},"description":"如果某一个资源被多个线程共享，为了避免因为资源抢占导致资源数据错乱，我们需要对线程进行同步，那么synchronized就是实现线程同步的关键字，是用来保证被锁定了代码同一时间只能有一个线程执行，那么synchronized关键字的实现原理是怎样的呢？ 先给出一张图，看看 synchronized 这个关键字有多复杂，先看看能看懂多少，如果看不太懂，希望看完本文能真正理解 synchronized"}</script><link rel="canonical" href="http://blog.cuzz.site/2020/09/09/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20synchronized%20%E5%85%B3%E9%94%AE%E5%AD%97/"><link rel="icon" href="/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.0.2"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="cuzz&#039;s blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/cuzz1"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2020-09-09T15:59:59.000Z" title="2020-09-09T15:59:59.000Z">2020-09-09</time></span><span class="level-item">Updated&nbsp;<time dateTime="2020-09-11T10:15:56.860Z" title="2020-09-11T10:15:56.860Z">2020-09-11</time></span><span class="level-item"><a class="link-muted" href="/categories/JAVA/">JAVA</a></span></div></div><h1 class="title is-3 is-size-4-mobile">深入理解 synchronized 关键字</h1><div class="content"><p>如果某一个资源被多个线程共享，为了避免因为资源抢占导致资源数据错乱，我们需要对线程进行同步，那么synchronized就是实现线程同步的关键字，是用来保证被锁定了代码同一时间只能有一个线程执行，那么synchronized关键字的实现原理是怎样的呢？</p>
<p>先给出一张图，看看 synchronized 这个关键字有多复杂，先看看能看懂多少，如果看不太懂，希望看完本文能真正理解 synchronized 关键字和这张图。</p>
<p><img src="http://img.cuzz.site/2020/4491294-e3bcefb2bacea224-20200910141026692.png"></p>
<a id="more"></a>

<h2 id="synchronized-用法"><a href="#synchronized-用法" class="headerlink" title="synchronized 用法"></a>synchronized 用法</h2><p>synchronized 在用法上可以分为如下四种：普通方法、对象、静态方法和类。</p>
<p>1、普通方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>2、对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(obj) &#123;       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3、静态方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>4、类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(Obj.class) &#123;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是我们要知道，syncnronized 锁的并不是代码块而是对象，锁静态方法也是锁住这个类。</p>
<h2 id="synchronized-特性"><a href="#synchronized-特性" class="headerlink" title="synchronized 特性"></a>synchronized 特性</h2><h3 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a>原子性</h3><h3 id="可见性"><a href="#可见性" class="headerlink" title="可见性"></a>可见性</h3><h3 id="有序性"><a href="#有序性" class="headerlink" title="有序性"></a>有序性</h3><h3 id="可重入性"><a href="#可重入性" class="headerlink" title="可重入性"></a>可重入性</h3><h2 id="synchronized-实现原理"><a href="#synchronized-实现原理" class="headerlink" title="synchronized 实现原理"></a>synchronized 实现原理</h2><h3 id="字节码"><a href="#字节码" class="headerlink" title="字节码"></a>字节码</h3><p>通过查看字节码来看看 synchronized 在字节码程度实现。</p>
<p>1、先看看在 synchronized 修饰在方法上</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>我们进入到编译后的 classes 目录下，找到对应的类，使用 <code>javap -v XX.class</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public synchronized void method();</span><br><span class="line">   descriptor: ()V</span><br><span class="line">   flags: (0x0021) ACC_PUBLIC, ACC_SYNCHRONIZED &#x2F;&#x2F; 注意这个</span><br><span class="line">   Code:</span><br><span class="line">     stack&#x3D;0, locals&#x3D;1, args_size&#x3D;1</span><br><span class="line">        0: return</span><br><span class="line">     LineNumberTable:</span><br><span class="line">       line 13: 0</span><br><span class="line">     LocalVariableTable:</span><br><span class="line">       Start  Length  Slot  Name   Signature</span><br><span class="line">           0       1     0  this   Lcom&#x2F;cuzz&#x2F;syn&#x2F;Test;</span><br></pre></td></tr></table></figure>

<p>我们发现在 flags 上有一个 ACC_SYNCHRONIZED 标识。</p>
<p>2、对象上</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span>(obj) &#123;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>反编译结果，在字节码成面上有 monitorenter 和 monitorexit，其中后面一个 monitorexit 表示异常退出。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">public void method();</span><br><span class="line">  descriptor: ()V</span><br><span class="line">  flags: (0x0001) ACC_PUBLIC</span><br><span class="line">  Code:</span><br><span class="line">    stack&#x3D;2, locals&#x3D;3, args_size&#x3D;1</span><br><span class="line">       0: aload_0</span><br><span class="line">       1: getfield      #3                  </span><br><span class="line">       4: dup</span><br><span class="line">       5: astore_1</span><br><span class="line">       6: monitorenter      &#x2F;&#x2F; ---&gt; 进入</span><br><span class="line">       7: aload_1</span><br><span class="line">       8: monitorexit       &#x2F;&#x2F; ---&gt; 退出</span><br><span class="line">       9: goto          17</span><br><span class="line">      12: astore_2</span><br><span class="line">      13: aload_1</span><br><span class="line">      14: monitorexit       &#x2F;&#x2F; ---&gt; 异常退出</span><br><span class="line">      15: aload_2</span><br><span class="line">      16: athrow</span><br><span class="line">      17: return</span><br></pre></td></tr></table></figure>

<h3 id="montor"><a href="#montor" class="headerlink" title="montor"></a>montor</h3><p>1、monitorenter JVM 规范中描述</p>
<blockquote>
<p>Each object is associated with a monitor. A monitor is locked if and only if it has an owner. The thread that executes monitorenter attempts to gain ownership of the monitor associated with objectref,  as follows: </p>
<ul>
<li>If the entry count of the monitor associated with objectref is zero,  the thread enters the monitor and sets its entry count to one. The thread is then the owner of the monitor. </li>
<li>If the thread already owns the monitor associated with objectref， it reenters the monitor， incrementing its entry count. </li>
<li>If another thread already owns the monitor associated with objectref， the thread blocks until the monitor’s entry count is zero， then tries again to gain ownership.</li>
</ul>
</blockquote>
<p>2、monitorexit JVM 规范中描述</p>
<blockquote>
<p>The thread that executes monitorexit must be the owner of the monitor associated with the instance referenced by objectref. The thread decrements the entry count of the monitor associated with objectref. If as a result the value of the entry count is zero， the thread exits the monitor and is no longer its owner. Other threads that are blocking to enter the monitor are allowed to attempt to do so.</p>
</blockquote>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>通过 javap 反汇编我们看到 synchronized 使用编程了 monitorentor 和 monitorexit 两个指令：</p>
<ul>
<li>每个锁对象都会关联一个 monitor （监视器它才是真正的锁对象）。</li>
<li>它内部有两个重要的成员变量 owner 会保存获得锁的线程，recursions 会保存线程获得锁的次数。</li>
<li>当执行到 monitorenter 时，recursions 会+1；当执行到 monitorexit 时，recursions会-1，当计数器减到 0 时这个线程就会释放锁。</li>
<li>同步方法在反汇编后，会增加 <code>ACC_SYNCHRONIZED</code> 修饰，会隐式调用 monitorenter 和 monitorexit。在执行同步方法前会调用 monitorenter，在执行完同步方法后会调用 monitorexit。</li>
</ul>
<h2 id="深入-JVM-源码"><a href="#深入-JVM-源码" class="headerlink" title="深入 JVM 源码"></a>深入 JVM 源码</h2><p>先下载 JVM 源码， <a target="_blank" rel="noopener" href="https://github.com/openjdk/jdk">https://github.com/openjdk/jdk</a> 导入 CLion 中，切到 1.8 tag 上。</p>
<p>在HotSpot虚拟机中，monitor 是由 ObjectMonitor 实现的。其源码是用 C++ 来实现的，位于HotSpot虚 拟机源码 ObjectMonitor.hpp 文件中(src/share/vm/runtime/objectMonitor.hpp)。ObjectMonitor  主要数据结构如下:</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">ObjectMonitor() &#123;</span><br><span class="line">    _header       = <span class="literal">NULL</span>;</span><br><span class="line">    _count        = <span class="number">0</span>;</span><br><span class="line">    _waiters      = <span class="number">0</span>,</span><br><span class="line">    _recursions   = <span class="number">0</span>;         <span class="comment">// 线程的重入次数</span></span><br><span class="line">    _object       = <span class="literal">NULL</span>;      <span class="comment">// 储存改monitor的对象</span></span><br><span class="line">    _owner        = <span class="literal">NULL</span>;      <span class="comment">// 标识拥有该monitor的线程</span></span><br><span class="line">    _WaitSet      = <span class="literal">NULL</span>;      <span class="comment">// 处于wait状态的线程，会加入到其中</span></span><br><span class="line">    _WaitSetLock  = <span class="number">0</span> ;</span><br><span class="line">    _Responsible  = <span class="literal">NULL</span> ;</span><br><span class="line">    _succ         = <span class="literal">NULL</span> ;</span><br><span class="line">    _cxq          = <span class="literal">NULL</span> ;     <span class="comment">// 多线程竞争锁的单向列表</span></span><br><span class="line">    FreeNext      = <span class="literal">NULL</span> ;</span><br><span class="line">    _EntryList    = <span class="literal">NULL</span> ;     <span class="comment">// 处于等待锁block状态的线程，会加入该列表</span></span><br><span class="line">    _SpinFreq     = <span class="number">0</span> ;</span><br><span class="line">    _SpinClock    = <span class="number">0</span> ;</span><br><span class="line">    OwnerIsThread = <span class="number">0</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>_owner</code>：初始时为NULL。当有线程占有该monitor时，owner标记为该线程的唯一标识。当线程 释放monitor时，owner又恢复为NULL。owner是一个临界资源，JVM是通过CAS操作来保证其线 程安全的。</li>
<li><code>_cxq</code>：竞争队列，所有请求锁的线程首先会被放在这个队列中（单向链表）。<code>_cxq</code>是一个临界资 源，JVM通过CAS原子指令来修改<code>_cxq</code>队列。修改前<code>_cxq</code>的旧值填入了node的next字段，<code>_cxq</code>指向新值(新线程)。因此<code>_cxq</code>是一个后进先出的栈。</li>
<li><code>_EntryList</code>：<code>_cxq</code>队列中有资格成为候选资源的线程会被移动到该队列中。</li>
<li><code>_WaitSet</code>：因为调用wait方法而被阻塞的线程会被放在该队列中。</li>
</ul>
<p>ObjectMonitor 的数据结构中包含：_owner、_WaitSet 和 _EntryList，它们之间的关系转换可以用下图表示:</p>
<p><img src="http://img.cuzz.site/20200911165817.png" alt="image-20200911165734818"></p>
<p>每一个 Java 对象都可以与一个监视器 monitor 关联，我们可以把它理解成为一把锁，当一个线程想要执行一段被 synchronized 圈起来的同步方法或者代码块时，该线程得先获取到 synchronized 修饰的对象对应的monitor。</p>
<p>我们的 Java 代码里不会显示地去创造这么一个monitor对象，我们也无需创建，事实上可以这么理解：</p>
<ul>
<li>monitor并不是随着对象创建而创建的。</li>
<li>我们是通过synchronized修饰符告诉 JVM 需要为我们的某个对象创建关联的monitor对象。</li>
<li>每个线程都存在两个ObjectMonitor 对象列表，分别为free和used列表。 同时JVM中也维护着global locklist。</li>
<li>当线程需要ObjectMonitor对象时，首先从线程自身的free表中申请，若存在则使用，若不存在则从global list中申请。</li>
</ul>
<h2 id="JVM-对-synchronzied-底层优化"><a href="#JVM-对-synchronzied-底层优化" class="headerlink" title="JVM 对 synchronzied 底层优化"></a>JVM 对 synchronzied 底层优化</h2><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1aJ411V763?from=search&seid=11835560625013508239">Java面试热点问题，synchronized原理剖析与优化</a></li>
</ul>
</div><div class="article-tags size-small mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/synchronized/">synchronized</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button is-info donate"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/img/alipay.png" alt="Alipay"></span></a><a class="button is-success donate"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/img/wechatpay.png" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/08/26/Dubbo%20SPI%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><span class="level-item">Dubbo SPI源码分析</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "f2e2d925516315db8d223da197df928f",
            repo: "cuzz1.github.io",
            owner: "cuzz1",
            clientID: "e829281603f9115c572d",
            clientSecret: "246dae10dfb1b363805ab98902dc93539c355bb3",
            admin: ["cuzz1"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" id="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="is-flex" href="#synchronized-用法"><span class="mr-2">1</span><span>synchronized 用法</span></a></li><li><a class="is-flex" href="#synchronized-特性"><span class="mr-2">2</span><span>synchronized 特性</span></a><ul class="menu-list"><li><a class="is-flex" href="#原子性"><span class="mr-2">2.1</span><span>原子性</span></a></li><li><a class="is-flex" href="#可见性"><span class="mr-2">2.2</span><span>可见性</span></a></li><li><a class="is-flex" href="#有序性"><span class="mr-2">2.3</span><span>有序性</span></a></li><li><a class="is-flex" href="#可重入性"><span class="mr-2">2.4</span><span>可重入性</span></a></li></ul></li><li><a class="is-flex" href="#synchronized-实现原理"><span class="mr-2">3</span><span>synchronized 实现原理</span></a><ul class="menu-list"><li><a class="is-flex" href="#字节码"><span class="mr-2">3.1</span><span>字节码</span></a></li><li><a class="is-flex" href="#montor"><span class="mr-2">3.2</span><span>montor</span></a></li><li><a class="is-flex" href="#小结"><span class="mr-2">3.3</span><span>小结</span></a></li></ul></li><li><a class="is-flex" href="#深入-JVM-源码"><span class="mr-2">4</span><span>深入 JVM 源码</span></a></li><li><a class="is-flex" href="#JVM-对-synchronzied-底层优化"><span class="mr-2">5</span><span>JVM 对 synchronzied 底层优化</span></a></li><li><a class="is-flex" href="#参考"><span class="mr-2">6</span><span>参考</span></a></li></ul></div></div><style>.menu-list > li > a.is-active + .menu-list { display: block; }.menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="cuzz&#039;s blog" height="28"></a><p class="size-small"><span>&copy; 2020 John Doe</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: false,
                    fold: ''
                }
            }
        };</script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"rect":"opacity:0.7","log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>